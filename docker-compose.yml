version: '3.8'

services:
  redis:
    image: "redis:latest"
    ports:
      - "6379:6379"
    environment:
      - REDIS_REPLICATION_MODE=master
      - REDIS_PASSWORD=your_password
      - REDIS_REQUIREPASS=another_password
    volumes:
      - redis-data:/data
    # networks:
    #   - mynetwork

  # timescaledb:
  #   image: timescale/timescaledb:latest-pg13
  #   container_name: my_timescaledb
  #   environment:
  #     POSTGRES_DB: gateio
  #     POSTGRES_USER: myuser
  #     POSTGRES_PASSWORD: mypassword
  #   ports:
  #     - "5432:5432"
  #   volumes:
  #     - timescaledb_data:/var/lib/postgresql/data
  #   networks:
  #     - mynetwork

  gateio-api:
    build:
      context: ./gateio_api
    # environment:
    #   - WS_URL=ws://gateio-ws:3000
    #   - INFLUXDB_URL=http://influxdb:8086
    #   - INFLUXDB_DATABASE=your_database_name
    ports:
      - "3001:3001"
    volumes:
      - api_data:/usr/src/app
    # networks:
    #   - mynetwork

  gateio-ws:
    build:
      context: ./gateio_ws
    environment:
      - API_URL=http://gateio-api:3001
      - TIMESCALE_DB=gateio
    ports:
      - "3003:3003"
    volumes:
    - ws_data:/usr/src/app
    # networks:
    #   - mynetwork

  # cron:
  #   build:
  #     context: ./cronjobs
  #   volumes:
  #     - cronjob_data:/usr/src/app


volumes:
  redis-data:
  ws_data:
  api_data:
  # timescaledb_data:
  # cronjob_data:

# networks:
#   mynetwork:
#     driver: bridge
